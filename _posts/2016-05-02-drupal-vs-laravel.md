---
title: '드루팔이냐 라라벨이냐'
layout: post
tags:
  - PHP
  - Framework
---

[<노동자 연대>](http://wspaper.org/) 웹사이트를 새로 구축하기로 결정했다. 

지금까지는 인트라넷 작업을 하느라 신문 웹사이트는 손을 많이 못 댔다. 그러나 앞으로는 웹사이트에 더 많이 공을 들이려고 계획중이다. 

지금 웹사이트는 2006년에 구현한 것이다. 당시 나는 아직 개발자가 아니었고, 다른 사람이 구축한 것인데, 많이 낡았다.


워드프레스
---------

자, 그렇다면 어떻게 구현해야 할까? 워드프레스도 고려했지만, 금세 아니라는 결론을 내렸다. 신문은 분류 체계가 중요한데, 함수를 이용해 `taxonomy`들을 등록하는 것이 꽤 골치아픈 일이 될 것 같았다. 사실 방법이야 쉽지만, 그런 코드를 배치하는 것 자체가 인간의 사고랑 잘 맞지 않아서 늘 적응이 잘 안 된다. 인간은 분류에 해당하는 코드를 짜거나, 아니면 그냥 DB에 저장한다. 훅을 이용해 `taxonomy`를 만드는 워드프레스의 방식은 아무래도 인간의 사고랑 잘 맞지 않는다.

게다가 관리자단을 커스터마이징하는 것이 가장 귀찮다. 관리자단에 페이지를 하나 추가하려면 함수를 하나 추가해야 하는데, 이것 역시 사고가 잘 적응이 안 된다. 역시나 방법이야 쉽지만 말이다. 페이지를 하나 만들 때는 파일을 하나 만드는 게 가장 쉽다. 그런데 함수를 만들어서 훅을 걸고, 좀 긴 페이지는 함수 안에서 파일을 가져 와야 하고... 에고고... 적성에 맞지 않는다.

워드프레스는 블로깅 플랫폼으로 출발했다. 블로그보다 약간 더 기능이 있는 사이트엔 어쩌면 적합할 지도 모르겠다. 나도 출판사나 단체 사이트를 워드프레스로 구축해 봤다. 그런데 그닥 즐거운 경험은 아니었다. 플러그인들을 이용하니 간편한 부분도 있었지만, 워드프레스 CMS의 규약에 맞추느라 코딩이 즐겁지 않은 부분도 있었다. CMS는 원래 기능 구현이 즐거워야 하는 것인데... 관리자단을 일일이 구현하고 페이지네이션을 직접 만들고 하는 것보단 즐거운 일이었지만, 훅과 필터의 바다에서 인간의 사고를 뜯어 고치는 게 그리 유쾌한 일은 아니었던 것 같다.

여튼 뭐 그래도 워드프레스는 괜찮은 플랫폼이다. 표준화는 좋은 일이다. 모든 표준이 그 자체로 훌륭한 것은 아니라도 말이다. 나도 계속 워드프레스 플러그인을 개발할 것이다.


Drupal
--------

많은 뉴스 사이트들이 어떤 프레임웍을 사용하는지 살펴 봤는데, [Newscoop](https://www.sourcefabric.org/en/newscoop/) 같은 뉴스CMS보다도 [드루팔](https://www.drupal.org/)을 더 많이 사용했다. 이건 내가 조사한 것은 아니고 [팀원](http://gnoownow10.cafe24.com/)이 조사한 것이다. 

[vox.com](http://vox.com/)의 코러스가 [그렇게 좋다는데,](http://www.bloter.net/archives/196694) 그건 공개돼 있는 것이 아니고...

그래서 팀원 중 한 명이 2박 3일 동안 드루팔을 공부해서 발표를 했다. 짧게 본 소감은 확장판 워드프레스 같았다는 것이다. 워드프레스는 코드에서 새로운 Post Type을 등록한다. 드루팔을 그것을 관리자 인터페이스로 처리한다. 심지어 관리자가 form을 만들어서 게시하는 기능까지 있다고 하니 (발표할 때 보진 못했지만) 정말 괜찮아 보였다.

물론 워드프레스에도 있는 거 안다. 그리고 Custom Post Type UI 플러그인 있는 것도 안다. 하지만 기본적 개념이 어떠냐 하는 것은 차이가 있는 것이다.

[소프트웨어 공학의 정의는 "소프트웨어를 최소 비용으로 최소 시간에 개발하는 방법"](http://www.allofsoftware.net/2008/12/blog-post_10.html)이라고 한다. 우리처럼 자원이 적은 곳에는 특히나 '최소 비용'과 '최소 시간'이 중요하다고 할 수 있겠다. 어디는 안 그러랴마는.

그렇다면 드루팔은 어쩌면 최선의 선택이 될 수 있지 않을까? Content Type(워드프레스의 Post Type에 해당하는 것)을 정의하고, 해당 Content의 필드들을 정의하면, 관리자 페이지가 만들어진다. 이 와중에 코딩이 개입되는 곳은 없다. 와우~ 그리고 이런 관리자단은 워드프레스보다 직관적으로 보였다.


### 규약의 저주 ###

하지만 비개발자에게 친숙해지면 친숙해질 수록 규약이 늘어난다. 

드루팔은 모듈과 테마라는 두 범주로 구성돼 있다. 기능은 모듈, 외양은 테마로 처리한다. 기능과 모양이 혼연일체를 이루는 워드프레스보다 구분은 명확해서 좋았다.[^fn]

하지만 역시 모듈은 훅과 필터... 별 수 있나. 기능을 주입하려면 훅과 필터지. 그리고 테마는 잘잘히 쪼개서 영역별로 정의... 그래... 별 수 없겠다 싶으면서도 내가 가장 많은 시간을 들여서 만질 신문 사이트에까지 규약에 종속돼 개발을 하고 싶진 않았다. 많은 규약과 함께 개발하다 보면 이건 PHP 개발이 아니라 드루팔 개발이 된다. 그게 나쁘다고만 말하는 건 아니다. 익숙해 지면 쉽게 사이트를 만들 수 있을 것이다. 나도 한 번 공부해 보려고 한다. 하지만, 역시 가장 많은 시간을 들이게 될 신문 사이트를 만질 때, drupal pagination 같은 검색어를 치면서 문서를 들여다 보고 하면서 개발을 하고 싶진 않았다. 

나쁘지 않다는 거 안다. 나도 편리하게 썼다. 하지만 엄청나게 많은 레고 부속들 속에서, 초기엔 딱 맞는 레고 부속을 찾느라고 시간을 들이는 것보다는 괜찮은 연장들을 제공하는 프레임웍이 더 낫지 않나 하는 생각을 했다는 것이다. 이것은 개발자의 정신건강에 관한 이야기라고 (약간 과장하면) 말할 수 있을 것이다.

여튼, 드루팔을 본 소감은, 알바엔 쓰겠다. 그런데, 메인 개발엔 못 쓰겠다. 규약 속에서 헤메고 싶지 않다! 정도 되겠다. 규약 나쁘지 않고, 워드프레스 개발 즐거운 면이 없지 않으나... 그래도 하드코딩보단 로망이 떨어진다...


라라벨
------

니가 그렇게 하드코딩이 좋으면 그냥 다 하드코딩하면 될 거 아냐?! 하고 말할 지도 모르겠다. 하지만 나는 생산성을 따지는 팀장이다. 바퀴를 다시 만들 필요는 없지 않은가? 그리고 드루팔이 만약 비약적으로 생산성이 높았다면 드루팔을 선택했을 지도 모르겠다. 하지만, 학습곡선이 가파르고, 개발자의 사기를 떨어뜨리는 작업환경이 될 수도 있다는 점이 드루팔이 아니라 라라벨을 고르는 데 영향을 미쳤다. 

예컨대, [라라벨](https://laravel.com/)을 보자.


### 커맨드 라인 ###

    php artisan make:model Note
    
이러면 `Note` 모델이 만들어진다. PHP가 커맨드라인이라니! 우리도 Django나 Rails처럼 할 수 있어![^fn2]

심지어 `laravel` 패키지를 설치해 `laravel new my-site` 하고 명령을 내릴 수도 있다. 만세~


### ORM(Object Relation Model) ###

이제 커맨드라인 말고 코드 안쪽을 보자. ORM의 힘이겠지만, 이런 코드가 된다.

    $note = Note::find(1);
    $other_notes = Note::where('id', '!=', '1')->get();
    
만세~!

왜 이게 만세냐고? ORM을 지원하지 않는 경량 프레임웍인 Code Igniter에선 Active Record를 지원하는데, 아래처럼 해야 한다.

    $note = $this->db->get_where('notes', ['id' => 1])->row();
    $other_notes = $this->db->get_where('notes', ['id !=' => 1])->result();
    
ORM과 Active Record의 차이인데, 규모가 중간만 넘어가도 ORM이 개발 속도를 더 빠르게 하지 않나 싶다.

각 데이터가 모델와 연결되므로, 아래와 같은 코드도 사용 가능하다.

    Note::whereId(1);
    

### 기타 ###
    
Composer로 설치할 수 있는 Laravel IDE Helper를 이용하면 자동완성도 잘 된다. 컴포저랑 통합돼 있으므로 수동으로 이것저것 건드릴 것 없이 초기 세팅만 한 번 해 주면 자동완성이 된다. 아무래도 Code Igniter는 역사가 깊은 프레임웍이다 보니, 기본적으로 Composer를 염두에 두고 개발된 (즉, 모듈화된) 라라벨보다 Composer와의 통합도가 떨어지는 듯하다. 

큐도 지원되고... 뭐... 그렇다.


최종 고민
--------

최종 고민은 관리자단을 만들어주지 않는 라라벨이 관리자단을 만들어 주는 드루팔에 비교해 얼마나 효율이 날 것인가 하는 것이었다. 그래서 관리자단을 만들어 주는 라라벨 플러그인을 찾아 보기도 했는데, 쓸만 한 게 없었다. 깔끔해 보이는 플러그인도 문서가 제대로 갖춰져 있지 않거나 했다.

그런데 생각해 보니, 모델이 깔끔하게 구현돼 있으면 관리자단을 만드는 것이 그리 어렵지 않을 것 같다는 생각이 들었다. 해 봐야 아는 일이겠지만.

여튼, 나의 결론은 이랬다.

"생산성 차이가 적다면 즐겁게 개발할 수 있는 것을 고르자."

개발자의 사기를 위해서 내린 결정이다.

짧게 단상을 쓴 거라 중구난방이다. 그래도 간략한 기록이라도 남기고 싶어 썼다. 


    








[^fn]: 워드프레스에서는 고가의 테마를 사서 많은 커스터마이징을 하고 나면 해당 테마에 종속된 데이터 타입들 때문에 이전비용이 높아진다. 드루팔이라고 전혀 안 그렇진 않을 테지만, 기본적으로 제공하는 Content Type과 테마 정의 덕에 좀더 낫지 않을까 하는 생각이 들기도 했다. 뭐, 워드프레스도 어차피 우리가 직접 구현할 테니 이전 비용 안 나게 개발하면 되지만서도...

[^fn2]: 아, Django를 사용할까도 생각해 봤다. 그런데 팀원들 대부분이 PHP에 가장 익숙한 상황에서 Django를 