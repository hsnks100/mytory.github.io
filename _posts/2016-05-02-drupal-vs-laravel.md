---
title: '드루팔이냐 라라벨이냐'
layout: post
tags:
  - PHP
  - Framework
---

[<노동자 연대>](http://wspaper.org/) 웹사이트를 새로 구축하기로 결정했다. 

지금까지는 인트라넷 작업을 하느라 신문 웹사이트는 손을 많이 못 댔다. 그러나 앞으로는 웹사이트에 더 많이 공을 들이려고 계획중이다. 

지금 웹사이트는 2006년에 구현한 것이다. 당시 나는 아직 개발자가 아니었고, 다른 사람이 구축한 것인데, 많이 낡았다.

아래는 구현할 CMS와 프레임웍을 고르면서 나름대로 비교한 것을 간략히 적은 것이다.


워드프레스
---------

우선 워드프레스를 고려하긴 했다. 그리고 비교적 간단하게 하지 않는 것으로 결론을 내렸다. 

물론 워드프레스는 훌륭한 CMS다. 국내 뉴스 사이트 중 [블로터](http://bloter.net)나 [레디앙](http://www.redian.org/) 같은 곳이 워드프레스로 구축돼 있다.

그런데 지난 몇 년 간 워드프레스로 사이트를 구축해 온 나에겐 두어가지 걸리는 점이 있었다. 

Post Type이나 Taxonomy(분류) 같은 것을 커스터마이징할 때 사고에 비용이 좀 든다는 것이 내 생각이다. 예컨대, 워드프레스는 분류를 추가하려면 테마나 플러그인에서 아래와 같은 코드를 사용한다(워드프레스 커스텀 분류 예제 코드).

<pre>
function people_init() {
	// create a new taxonomy
	register_taxonomy(
		'people',
		'post',
		array(
			'label' => __( 'People' ),
			'rewrite' => array( 'slug' => 'person' ),
			'capabilities' => array(
				'assign_terms' => 'edit_guides',
				'edit_terms' => 'publish_guides'
			)
		)
	);
}
add_action( 'init', 'people_init' );
</pre>

글 종류를 서너개만 만들어도 이런 코드가 여러 개 생긴다. label을 붙이는 것도 꽤 성가시게 느껴진다. 사실 분류는 디비에 넣거나 하드코딩하는 것이 (코딩 철학으로서가 아니라) 사고 과정에 잘 맞는다. 예컨대, 게시판 카테고리는 그냥 DB의 `category` 컬럼에 들어 있는 것을 사용하면 된다. 인지 비용[^fn3]이 낮다. 이에 비해 워드프레스는 생각을 약간 틀어야 한다. 내가 느끼기엔 약간 왜곡된다. 

사실 CMS로서는 훅이나 필터를 사용하는 것이 자연스러운 일이긴 하다. 그래서 CMS로선 좋다고 말할 수 있을 지 모르지만, 내가 가장 많이 작업하게 될 사이트를 만드는 데는 그리 좋게 느껴지지 않았다.

관리자단을 커스터마이징하는 것도 같은 측면에서 턱 걸리는 것이 있는 것처럼 느껴졌다. 워드프레스에선 관리자단에 페이지를 하나 추가하려면 함수를 몇 개 추가해야 한다. 아래는 플러그인 페이지를 추가하는 함수다. 맨 마지막 인자값인 `$function`이 콜백 함수고, 이 콜백함수가 페이지의 HTML을 들고 있다. 

    add_plugins_page( $page_title, $menu_title, $capability, $menu_slug, $function);
    
잘 이해가 안 되면 넘어가자. 이해하면 그리 어렵진 않다는 건 일단 말해 둔다. 하지만, 직관적이지 않다는 문제는 남는데, 이게 내가 워드프레스를 고르기 껄끄러웠던 이유다. 함수를 만들고, 훅을 걸고, 훅에서 함수를 호출하고, 해당 함수가 HTML을 렌더링하고... 이게 그리 직관적이진 않다.

워드프레스는 블로그 플랫폼으로 출발했다. 그리고 다양한 훅과 필터를 바탕으로 플러그인 생태계를 이뤘다. 이 점은 크나큰 장점이다. 그러나 역설적으로 이 장점이 나에겐 약간의 단점이 되었다.

사실 어떻게 보면 워드프레스는 표준화된 사이트다. 프로그래밍을 레고 블럭으로 대체하려는 노력은 오래 전부터 있어 왔는데, 어쩌면 워드프레스가 그렇게 보일 지도 모르겠다. 여전히 필요에 맞는 사이트를 구현하려면 많은 코드를 직접 짜야 하지만, 관리자 페이지가 기본으로 구현돼 있고, 괜찮은 플러그인이 꽤 있다는 점은 큰 장점이다. 나도 User Role, Google analyticator, Limit Login Attempts, W3 Total Cache 같은 플러그인을 사용한다. 내가 만든 Uploading downloading non-latin filename 플러그인도 잘 사용하고 있다(이건 비록 워드프레스의 단점을 보완하는 역할을 하는 플러그인이지만 말이다).

앞으로도 많은 사이트를 워드프레스로 구축하려고 한다. 하지만, 이번에 만들 신문 사이트에는 아니라는 결론을 내렸다. 많은 시간을 사이트 개발 자체를 하면서 보내게 될 것이고, 다양하고 유연한 기능들이 많이 들어가야만 하는 사이트다. 인지 비용이 드는 워드프레스는 뭔가 맞지 않는다는 생각을 했다. 


Drupal
--------

워드프레스를 후보에서 제외한 뒤에는 해외 뉴스 사이트들이 어떤 프레임웍을 사용하는지 살펴 봤는데, [Newscoop](https://www.sourcefabric.org/en/newscoop/) 같은 뉴스CMS보다도 [드루팔](https://www.drupal.org/) 같은 일반화된 CMS를 더 많이 사용했다. 하긴 CMS는 생태계가 훨씬 중요할 테니 그럴 법하다는 생각이 들었다.[^fn4]

[vox.com](http://vox.com/)의 코러스가 [그렇게 좋다는데,](http://www.bloter.net/archives/196694) 그건 공개돼 있는 것이 아니고...

그래서 팀원 중 한 명이 2박 3일 동안 드루팔을 공부해서 발표를 했다. 짧게 본 소감은 확장판 워드프레스 같았다는 것이다. 워드프레스는 코드에서 새로운 Post Type을 등록한다. 드루팔을 그것을 관리자 인터페이스로 처리한다. 심지어 관리자가 form을 만들어서 게시하는 기능까지 있다고 하니 (발표할 때 보진 못했지만) 정말 괜찮아 보였다.

물론 워드프레스에도 있는 거 안다. 그리고 Custom Post Type UI 플러그인 있는 것도 안다. 하지만 기본적 개념이 어떠냐 하는 것은 차이가 있는 것이다.

[소프트웨어 공학의 정의는 "소프트웨어를 최소 비용으로 최소 시간에 개발하는 방법"](http://www.allofsoftware.net/2008/12/blog-post_10.html)이라고 한다. 우리처럼 자원이 적은 곳에는 특히나 '최소 비용'과 '최소 시간'이 중요하다고 할 수 있겠다. 어디는 안 그러랴마는.

그렇다면 드루팔은 어쩌면 최선의 선택이 될 수 있지 않을까? Content Type(워드프레스의 Post Type에 해당하는 것)을 정의하고, 해당 Content의 필드들을 정의하면, 관리자 페이지가 만들어진다. 이 와중에 코딩이 개입되는 곳은 없다. 와우~ 그리고 이런 관리자단은 워드프레스보다 직관적으로 보였다.


### 규약의 저주 ###

하지만 비개발자에게 친숙해지면 친숙해질 수록 규약이 늘어난다. 

드루팔은 모듈과 테마라는 두 범주로 구성돼 있다. 기능은 모듈, 외양은 테마로 처리한다. 기능과 모양이 혼연일체를 이루는 워드프레스보다 구분은 명확해서 좋았다.[^fn1]

하지만 역시 모듈은 훅과 필터... 별 수 있나. 기능을 주입하려면 훅과 필터지. 그리고 테마는 잘잘히 쪼개서 영역별로 정의... 그래... 별 수 없겠다 싶으면서도 내가 가장 많은 시간을 들여서 만질 신문 사이트에까지 규약에 종속돼 개발을 하고 싶진 않았다. 많은 규약과 함께 개발하다 보면 이건 PHP 개발이 아니라 드루팔 개발이 된다. 그게 나쁘다고만 말하는 건 아니다. 익숙해 지면 쉽게 사이트를 만들 수 있을 것이다. 나도 한 번 공부해 보려고 한다. 하지만, 역시 가장 많은 시간을 들이게 될 신문 사이트를 만질 때, drupal pagination 같은 검색어를 치면서 문서를 들여다 보고 하면서 개발을 하고 싶진 않았다. 

나쁘지 않다는 거 안다. 나도 편리하게 썼다. 하지만 엄청나게 많은 레고 부속들 속에서, 초기엔 딱 맞는 레고 부속을 찾느라고 시간을 들이는 것보다는 괜찮은 연장들을 제공하는 프레임웍이 더 낫지 않나 하는 생각을 했다는 것이다. 이것은 개발자의 정신건강에 관한 이야기라고 (약간 과장하면) 말할 수 있을 것이다.

여튼, 드루팔을 본 소감은, 알바엔 쓰겠다. 그런데, 메인 개발엔 못 쓰겠다. 규약 속에서 헤메고 싶지 않다! 정도 되겠다. 규약 나쁘지 않고, 워드프레스 개발 즐거운 면이 없지 않으나... 그래도 하드코딩보단 로망이 떨어진다...


라라벨
------

니가 그렇게 하드코딩이 좋으면 그냥 다 하드코딩하면 될 거 아냐?! 하고 말할 지도 모르겠다. 하지만 나는 생산성을 따지는 팀장이다. 바퀴를 다시 만들 필요는 없지 않은가? 그리고 드루팔이 만약 비약적으로 생산성이 높았다면 드루팔을 선택했을 지도 모르겠다. 하지만, 학습곡선이 가파르고, 개발자의 사기를 떨어뜨리는 작업환경이 될 수도 있다는 점이 드루팔이 아니라 라라벨을 고르는 데 영향을 미쳤다. 

예컨대, [라라벨](https://laravel.com/)을 보자.


### 커맨드 라인 ###

    php artisan make:model Note
    
이러면 `Note` 모델이 만들어진다. PHP가 커맨드라인이라니! 우리도 Django나 Rails처럼 할 수 있어![^fn2]

심지어 `laravel` 패키지를 설치해 `laravel new my-site` 하고 명령을 내릴 수도 있다. 만세~


### ORM(Object Relation Model) ###

이제 커맨드라인 말고 코드 안쪽을 보자. ORM의 힘이겠지만, 이런 코드가 된다.

    $note = Note::find(1);
    $other_notes = Note::where('id', '!=', '1')->get();
    
만세~!

왜 이게 만세냐고? ORM을 지원하지 않는 경량 프레임웍인 Code Igniter에선 Active Record를 지원하는데, 아래처럼 해야 한다.

    $note = $this->db->get_where('notes', ['id' => 1])->row();
    $other_notes = $this->db->get_where('notes', ['id !=' => 1])->result();
    
ORM과 Active Record의 차이인데, 규모가 중간만 넘어가도 ORM이 개발 속도를 더 빠르게 하지 않나 싶다.

각 데이터가 모델와 연결되므로, 아래와 같은 코드도 사용 가능하다.

    Note::whereId(1);
    

### 기타 ###
    
Composer로 설치할 수 있는 Laravel IDE Helper를 이용하면 자동완성도 잘 된다. 컴포저랑 통합돼 있으므로 수동으로 이것저것 건드릴 것 없이 초기 세팅만 한 번 해 주면 자동완성이 된다. 아무래도 Code Igniter는 역사가 깊은 프레임웍이다 보니, 기본적으로 Composer를 염두에 두고 개발된 (즉, 모듈화된) 라라벨보다 Composer와의 통합도가 떨어지는 듯하다. 

큐도 지원되고... 뭐... 그렇다.


최종 고민
--------

최종 고민은 관리자단을 만들어주지 않는 라라벨이 관리자단을 만들어 주는 드루팔에 비교해 얼마나 효율이 날 것인가 하는 것이었다. 그래서 관리자단을 만들어 주는 라라벨 플러그인을 찾아 보기도 했는데, 쓸만 한 게 없었다. 깔끔해 보이는 플러그인도 문서가 제대로 갖춰져 있지 않거나 했다.

그런데 생각해 보니, 모델이 깔끔하게 구현돼 있으면 관리자단을 만드는 것이 그리 어렵지 않을 것 같다는 생각이 들었다. 해 봐야 아는 일이겠지만.

여튼, 나의 결론은 이랬다.

"생산성 차이가 적다면 즐겁게 개발할 수 있는 것을 고르자."

개발자의 사기를 위해서 내린 결정이다.

짧게 단상을 쓴 거라 중구난방이다. 그래도 간략한 기록이라도 남기고 싶어 썼다. 


    








[^fn1]: 워드프레스에서는 고가의 테마를 사서 많은 커스터마이징을 하고 나면 해당 테마에 종속된 데이터 타입들 때문에 이전비용이 높아진다. 드루팔이라고 전혀 안 그렇진 않을 테지만, 기본적으로 제공하는 Content Type과 테마 정의 덕에 좀더 낫지 않을까 하는 생각이 들기도 했다. 뭐, 워드프레스도 어차피 우리가 직접 구현할 테니 이전 비용 안 나게 개발하면 되지만서도...

[^fn2]: 아, Django를 사용할까도 생각해 봤다. 그런데 팀원들 대부분이 PHP에 가장 익숙한 상황에서 Django를 

[^fn3]: 인지 비용은 이 글에서 내가 그냥 사용하는 말이다. 직관적으로 이해가 잘 되면 인지 비용이 낮다고 표현할 것이고, 그렇지 않은 경우 높다고 표현하는 것이다.

[^fn4]: 이건 내가 조사한 것은 아니고 [팀원](http://gnoownow10.cafe24.com/)이 조사한 것이다. 